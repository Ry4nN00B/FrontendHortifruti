<div class="page-container">
  <h1 class="page-title">Gerenciar Categorias </h1>

  <div *ngIf="statusMessage" class="toast" [ngClass]="statusType">
    {{ statusMessage }}
  </div>

  <section class="card-table-container">
    <div class="table-header-actions">
      <h2 class="card-title">Todas Categorias</h2>
      <div class="action-buttons">
        <button class="btn btn-secondary btn-icon" (click)="toggleFilters()">Filtros</button>
        <button class="btn btn-primary btn-icon" (click)="openCategoryAddModal()">Adicionar Categoria</button>
      </div>
    </div>

    <div class="table-wrapper">
      <table class="data-table">
        <thead>

          <div *ngIf="statusMessage" class="toast" [ngClass]="statusType">
            {{ statusMessage }}
          </div>

          <tr>
            <th>Nome</th>
            <th>Descrição</th>
            <th style="width: 150px;">Ações</th>
          </tr>

          <!-- Filters -->
          <tr *ngIf="showFilters" class="filter-row">
            <th><input type="text" placeholder="Filtrar nome" [(ngModel)]="filters.name" (input)="applyFilters()" />
            </th>
            <th><input type="text" placeholder="Filtrar descrição" [(ngModel)]="filters.description"
                (input)="applyFilters()" /></th>

            <th></th>
          </tr>

        </thead>
        <tbody>
          <tr *ngFor="let category of categoriesPaginated">
            <td>{{ category.name }}</td>
            <td>{{ category.description }}</td>
            <td>
              <button class="btn-action edit" (click)="editCategory(category)">Editar</button>
              <button class="btn-action delete" (click)="deleteCategory(category.id)">Excluir</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="pagination" *ngIf="totalPages > 0">
      <span>Página {{ currentPage }} de {{ totalPages }}</span>

      <!-- Controls only appear if there is more than one page -->
      <div class="pagination-controls" *ngIf="totalPages > 1">
        <button class="btn btn-secondary" (click)="previousPage()" [disabled]="currentPage === 1">
          Anterior
        </button>

        <button class="btn btn-secondary" (click)="nextPage()" [disabled]="currentPage === totalPages">
          Próximo
        </button>
      </div>
    </div>

  </section>
</div>

<categoryForm *ngIf="showModal" [category]="selectedCategory" (categoryCreate)="onCategoryCreate()"
  (categorySaved)="onCategorySaved()" (closeModal)="closeCategoryAddModal()">
</categoryForm>